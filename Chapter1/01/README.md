# 1장 : HTTP 개관
> 얼마나 많은 클라이언트와 서버가 통신하는지


> 리소스(웹 콘텐츠)가 어디서 오는지


> 웹 트랜잭션이 어떻게 동작하는지


> HTTP 통신을 위해 사용하는 메시지의 형식


> HTTP 기저의 TCP 네트워크 전송


> 여러 종류의 HTTP 프로토콜


> 인터넷 곳곳에 설치된 다양한 HTTP 구성요소


## 1.1 HTTP : 인터넷의 멀티미디어 배달부
- 신뢰성 있는 연결을 보장하기 때문에 전송 중 손상되거나 왜곡되는 것을 걱정하지 않아도 된다. 이는 사용자와 개발자 모두에게 이롭다.

## 1.2 웹 클라이언트와 서버
- 웹 콘텐츠는 웹 서버에 존재한다. 웹 서버는 HTTP 프로토콜로 의사소통하기 때문에 보통 HTTP 서버라고 불린다.
- 웹 서버는 데이터를 저장하고, HTTP 클라이언트가 요청한 데이터를 제공
- 클라이언트가 요청한 데이터를 웹 서버는 응답으로 돌려준다.

** HTTP 클라이언트와 HTTP 서버는 월드 와이드 웹의 기본 요소 **

## 1.3 리소스
- 웹 서버는 리소스를 관리하고 제공한다.
- 웹 리소스는 웹 콘텐츠의 원천이다.
  - 가장 단순한 웹 리소스는 웹 서버 파일 시스템의 정적 파일
  > 정적 파일 <br>
  > 텍스트 파일, HTMl 파일, 마이크로소프트 워드 파일, 어도비 아크로뱃 파일, JPEG 이미지 파일, AVI 동영상 파일, 그 외 모든 종류의 파일을 포함
- 동적 콘텐츠도 리소스가 될 수 있다. => 어떤 콘텐츠 소스도 리소스가 될 수 있다.
  - 기업 판매예측 스프레드시트 파일, 지역 공공 도서관의 서가를 탐색하는 웹 게이트웨이, 인터넷 검색엔진 전부 리소스다.

  ### 1.3.1 미디어 타입
   - 인터넷은 수천 가지 데이터 타입을 다루기 때문에 HTTP는 웹에서 전송되는 객체 각각에 신중하게 `MIME` 타입이라는 데이터 포맷 라벨을 붙인다.
   > MIME(Multipurpose Internet Mail Extensions, 다목적 인터넷 메일 확장) </br>
   > 이는 원래 각기 다른 전자메일 시스템 사이에서 메시지가 오갈 때 겪는 문제점을 해결하기 위해 설계되었다. </br>
   > MIME은 이메일에서 워낙 잘 동작했기 때문에, HTTP에서도 멀티미디어 콘텐츠를 기술하고 라벨을 붙이기 위해 채택되었다.

   - 웹 서버는 모든 HTTP 객체 데이터에 MIME 타입을 붙인다.
   - 웹 브라우저는 서버로부터 객체를 돌려받을 때, 다룰 수 있는 객체인지 MIME 타입을 통해 확인한다.
   ```text
    - HTML : text/html
    - plain ASCII : text/plain
    - JPEG : image/jpeg
    - GIF : image/gif
    - apple quickTime Video : video/quicktime
    - Microsoft PPT : application/vnd.ms-powerpoint
    ** 부록  D 참조
   ```

   ### 1.3.2 URI (Uniform Resource Identifier, 통합 자원 식별자)
    - 인터넷의 우편물 주소 : 정보 리소스를 고유하게 식별하고 위치를 지정할 수 있다.
  
  ### 1.3.3 URL (Uniform Resource Locator, 통합 자원 지시자)
  - 특정 서버의 한 리소스에 대한 구체적인 위치를 서술
  - 프로토콜, 서버, 리소스를 명시
  - 표준 포맷
    > 1. Scheme (스킴 또는 스키마) </br>
    > 리소스에 접근하기 위해 사용되는 프로토콜을 서술한다. 보통 HTTP이다.

    > 2. 서버의 인터넷 주소

    > 3. 웹 서버의 리소스
  
  ### 1.3.4 URN (Uniform Resource Name, 유니폼 리소스 이름)
  - 콘텐츠를 이루는 한 리소스에 대해, 그 리소스의 위치에 영향 받지 않는 유일무이한 이름 역할을 함
  - 위치 독립적인 URN은 리소스를 여기저기로 옮기더라도 문제없이 동작한다.
  
## 1.4 트랜잭션 (Transaction)
: 데이터베이스의 상태를 변화시키기 위해 수행하는 작업의 단위를 말한다.
- HTTP 트랜잭션은 요청 명령(클라이언트에서 서버로 보내는)과 응답 결과(서버가 클라이언트에게 돌려주는)로 구성되어 있다.

  ### 1.4.1 메서드 (Method)
  - HTTP는 HTTP 메서드라고 불리는 여러 가지 종류의 요청 명령을 지원한다.
  - 모든 HTTP 요청 메시지는 하나의 메서드를 갖는다.
  - GET / PUT / DELETE / POST / HEAD  ...

  ### 1.4.2 상태 코드
  - HTTP 응답 메시지는 상태 코드와 함께 반환됨
  - 200 굳 / 302 다시 보내 / 404 리소스 못찾음, 없음
  - 상태코드와 사유 구절 (reason phrase) 

  ### 1.4.3 웹 페이지는 여러 객체로 이루어질 수 있다
  - '웹 페이지'는 하나의 리소스가 아닌 리소스의 모음이다.

## 1.5 메시지
- Request : 클라이언트 -> 서버
- Response : 서버 -> 클라이언트
- 구성
  > 요청 메서드 GET / POST / DELETE 등 </br>
  > 헤더                              </br>
  > 본문                              </br>

## 1.6 TCP 커넥션
어떻게 HTTP 메시지가 TCP(Transmission Control Protocol, 전송 제어 프로토콜) 커넥션을 통해 한 곳에서 다른 곳으로 옮겨가는가?

  ### 1.6.1 TCP/IP
  HTTP는 애플리케이션 계층 프로토콜이다. 네트워크 통신의 핵심적인 세부사항에 대해서 신경쓰지 않는다.
  - 대신 대중적이고 신뢰성 있는 인터넷 전송 프로토콜인 TCP/IP에게 맡긴다.
  - TCP는 다음을 제공한다.
    1. 오류 없는 데이터 전송
    2. 순서에 맞는 전달 (데이터는 언제나 보낸 순서대로 도착한다)
    3. 조각나지 않는 데이터 스트림 (언제든 어떤 크기로든 보낼 수 있다)
  - 인터넷 자체가 전 세계의 컴퓨터와 네트워크 장치들 사이에서 대중적으로 사용되는 TCP/IP에 기초하고 있다.
  - TCP/IP는 TCP와 IP가 층을 이루는, 패킷 교환 네트워크 프로토콜의 집합이다.
  - TCP/IP는 각 네트워크와 하드웨어의 특성을 숨기고, 어떤 종류의 컴퓨터나 네트워크든 서로 신뢰성 있는 의사소통을 하게 해준다.
  - 일단 TCP 커넥션이 맺어지면, 클라이언트와 서버 컴퓨터 간에 교환되는 메시지가 없어지거나, 손상되거나, 순서가 뒤바뀌어 수신되는 일은 결코 없다.

  ### 1.6.2 접속, IP주소 그리고 포트번호
  - IP (Internet Protocol. 인터넷 프로토콜)
  - HTTP 통신 이전에는 서버 컴퓨터에 대한 IP주소와 서버 프로그램이 사용 중인 포트 번호가 필요했다.
    - URL을 이용해 IP주소와 포트 번호를 알아낼 수 있다.
    - 숫자로 된 IP 주소 또는 도메인 (DNS, Domain Name Service)을 통해 IP로 변환 가능한 형태
    - 포트 번호가 없다면 기본적으로 80포트를 사용하는 것이다.
  - 과정
    1. 웹브라우저는 서버의 URL에서 호스트 명을 추출한다.
    2. 웹브라우저는 서버의 호스팅 명을 IP로 변환한다.
    3. 웹브라우저는 URL에서 포트번호(있다면) 추출한다.
    4. 웹브라우저는 웹 서버와 TCP 커넥션을 맺는다.
    5. 웹브라우저는 서버에 HTTP 요청을 보낸다.
    6. 서버는 웹브라우저에 HTTP 응답을 돌려준다.
    7. 커넥션이 닫히면, 웹 브라우저는 문서를 보여준다.

  ### 1.6.3 텔넷(Telnet)을 이용한 실제 예제
  > 텔넷 (Telnet)이 뭐야? </br>
  > 네트워크 상에서 다른 컴퓨터에 원격 로그인하거나 원격으로 명령을 실행하기 위한 프로토콜이다. </br>
  > 텍스트 기반 터미널을 사용하여 포트 번호 23번으로 다른 컴퓨터에 접근한다. </br>
  > 보안에 취약해 현재는 SSH(Secure Shell)를 사용한다.

    #### SSH (Secure Shell)
    원격으로 호스트에 접속하기 위해 사용되는 보안 프로토콜이다.
    - 대칭키 암호화 방식을 사용하여 암호화한다.
    1. 구성요소
    대칭키 암호화 (Symmetric key algorithm)
    - Public Key : 암호화 담당 (외부에 노출되어도 비교적 안전한 Key )
    - Private Key : 복호화 담당 (외부에 노출되면 절대 안되는 Key)

  - 텔넷 유틸리티는 목적지 TCP포트로 사용자의 키보드를 연결해주고, 출력 TCP 포트를 사용자의 화면으로 연결해준다.

## 1.7 프로토콜 버전
 1. HTTP/0.9
 : 심각한 디자인 결함과 구식 클라이언트만 가능한 상호작용.
 2. HTTP/1.0
 : 널리 쓰이기 시작한 HTTP 버전. 헤더, 추가 메서드, 멀티미디어 객체 처리가 추가되었다.
 3. HTTP/1.0+
 : WWW의 급격한 팽창으로 다양한 웹 클라이언트와 서버들의 요구를 만족시키기 위해 여러 기능이 추가되었다. </br>
  - keep-alive 커넥션, 가상 호스팅 지원, 프락시 연결 지원 등 공식은 아니지만, 사실상 표준으로 추가되었다.
4. HTTP/1.1
 : HTTP설계의 구조적 결함 교정, 두드러진 성능 최적화, 잘못된 기능 제거에 집중
5. HTTP/2.0
 : HTTP/1.1 성능 문제 개선을 위해 구글의 SPDY 프로토콜을 기반으로 설계가 진행 중인 프로토콜이다.

## 1.8 웹의 구성요소
1. 프락시
: 클라이언트와 서버 사이에 위치한 HTTP 중개자
2. 캐시
: 많이 찾는 웹페이지를 클라이언트 가까이에 보관하는 HTTP 창고
3. 게이트웨이
: 다른 애플리케이션과 연결된 특별한 웹 서버
4. 터널
: 단순히 HTTP 통신을 전달하기만 하는 특별한 프락시
5. 에이전트
: 자동화된 HTTP 요청을 만드는 준지능적(semi-intelligent) 웹클라이언트

  ### 1.8.1 프락시 (Proxy, 대리자)
  웹 보안, 애플리케이션 통합, 성능 최적화를 위한 중요한 구성요소이다.
  > 클라이언트 > 프락시(요청을 수정하여 서버에 전달) > 서버
  - 보안을 위해 사용
    : 모든 웹 트래픽 흐름 속에서 신뢰할 만한 중개자 역할을 함
    - 요청과 응답을 필터링
  
  ### 1.8.2 캐시 (Cache)
  웹 캐시와 캐시 프락시는 자신을 거쳐 가는 문서들 중 자주 찾는 것의 사본을 저장해 두는, 특별한 종류의 HTTP 프락시 서버이다.
- 클라이언트는 멀리 떨어진 웹 서버보다 근처의 캐시에서 훨씬 더 빨리 문서를 다운 받을 수 있다.
- HTTP는 캐시를 효율적으로 동작하게 하고 캐시된 콘텐츠를 최신 버전으로 유지하면서 동시에 프라이버시도 보호하기 위한 많은 기능을 정의한다.

  ### 1.8.3 게이트웨이 (Gate Way, 관문)
  게이트웨이는 다른 서버들의 중재자로 동작하는 특별한 서버이다.
  - 주로 HTTP 트래픽을 다른 프로토콜로 변환하기 위해 사용된다.
  - 언제나 스스로가 리소스를 갖고 있는 진짜 서버인 것처럼 요청을 다룬다.
  - 클라이언트는 자신이 게이트웨이와 통신하고 있음을 알아채지 못할 것이다.

  > 동작 방식 </br>
  > HTTP/FTP 게이트웨이는  FTP URI에 대한 HTTP 요청을 받아들인 뒤, FTP 프로토콜을 이용해 문서를 가져온다. </br>
  > 받아온 문서는 HTTP 메시지에 담겨 클라이언트에게 보낸다.

  ### 1.8.4 터널 
  터널은 두 커넥션 사이에서 날(raw) 데이터를 열어보지 않고 그대로 전달해주는 HTTP 애플리케이션이다.
  - 주로 비 HTTP 데이터를 하나 이상의 HTTP 연결을 통해 그대로 전송해주기 위해 사용된다.
  - HTTP 터널을 활용하는 대표적인 예
    - 암호화된 SSL 트래픽을 HTTP 커넥션으로 전송함으로써 웹 트래픽만 허용하는 사내 방화벽을 통과시키는 것이 있다.
    - HTTP/SSL 터널은 HTTP 요청을 받아들여 목적지의 주소와 포트번호로 커넥션을 맺는다. 이후부터는 SSL 트래픽을 HTTP 채널을 통해 목적지 서버로 전송할 수 있게 된다.

  ### 1.8.5 에이전트
  사용자 에이전트(혹은 그냥 에이전트)는 사용자를 위해 HTTP 요청을 만들어주는 클라이언트 프로그램이다. 웹 요청을 만드는 애플리케이션은 뭐든 HTTP 에이전트다.
   - 웹 요청을 만드는 애플리케이션은 뭐든 HTTP 에이전트다.
